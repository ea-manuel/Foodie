<!DOCTYPE html>
<html>
  <head>
    <title>Foodie</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        overflow-x: hidden;
        position: relative;
      }

      /* Floating ingredients animation */
      .floating-ingredient {
        position: fixed;
        font-size: 2rem;
        opacity: 0.3;
        animation: float 6s ease-in-out infinite;
        pointer-events: none;
        z-index: 1;
      }

      .floating-ingredient:nth-child(1) {
        top: 10%;
        left: 10%;
        animation-delay: 0s;
      }
      .floating-ingredient:nth-child(2) {
        top: 20%;
        right: 15%;
        animation-delay: 1s;
      }
      .floating-ingredient:nth-child(3) {
        bottom: 30%;
        left: 5%;
        animation-delay: 2s;
      }
      .floating-ingredient:nth-child(4) {
        bottom: 20%;
        right: 10%;
        animation-delay: 3s;
      }
      .floating-ingredient:nth-child(5) {
        top: 50%;
        left: 5%;
        animation-delay: 4s;
      }
      .floating-ingredient:nth-child(6) {
        top: 60%;
        right: 5%;
        animation-delay: 5s;
      }
      .floating-ingredient:nth-child(7) {
        bottom: 50%;
        left: 20%;
        animation-delay: 1.5s;
      }
      .floating-ingredient:nth-child(8) {
        top: 30%;
        right: 25%;
        animation-delay: 2.5s;
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0px) rotate(0deg);
        }
        50% {
          transform: translateY(-20px) rotate(5deg);
        }
      }

      .main {
        display: flex;
        flex-direction: column;
        background: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)),
          url(main_3.jpg);
        background-repeat: no-repeat;
        background-size: cover;
        background-position: center;
        width: 100%;
        min-height: 100vh;
        align-items: center;
        justify-content: center;
        text-align: center;
        position: relative;
        z-index: 2;
      }

      .main_header {
        font-family: Sablobe, "Segoe UI", cursive;
        text-align: center;
        font-size: 4.5rem;
        color: #fff;
        text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.7);
        margin-bottom: 2rem;
        animation: fadeInDown 1s ease-out;
      }

      .search-container {
        background: rgba(255, 255, 255, 0.95);
        padding: 2rem;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(10px);
        margin-bottom: 2rem;
        animation: fadeInUp 1s ease-out 0.3s both;
      }

      .text_input {
        border: 2px solid #e0e0e0;
        border-radius: 25px;
        width: 500px;
        padding: 15px 20px;
        font-size: 1rem;
        outline: none;
        transition: all 0.3s ease;
        background: white;
      }

      .text_input:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .submit_button {
        background: linear-gradient(45deg, #667eea, #764ba2);
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        position: relative;
        right: 60px;
        bottom: 5px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
      }

      .submit_button:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
      }

      .view_recipe {
        background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        border: none;
        border-radius: 25px;
        width: 150px;
        height: 50px;
        color: white;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
        margin-top: 1rem;
      }

      .view_recipe:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(255, 107, 107, 0.6);
      }

      .textarea_container {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      /* Recipe Display Section */
      .recipes-section {
        width: 100%;
        max-width: 1200px;
        margin: 2rem auto;
        padding: 0 2rem;
      }

      .recipes-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        margin-top: 2rem;
      }

      .recipe-card {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        padding: 1.5rem;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .recipe-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
      }

      .recipe-name {
        font-size: 1.3rem;
        font-weight: 600;
        color: #333;
        margin-bottom: 0.5rem;
        text-align: center;
      }

      .no-recipes {
        text-align: center;
        color: #fff;
        font-size: 1.2rem;
        background: rgba(255, 255, 255, 0.1);
        padding: 2rem;
        border-radius: 15px;
        backdrop-filter: blur(10px);
      }

      .ingredient-list {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 15px;
        padding: 1rem;
        margin: 1rem auto;
        max-width: 600px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      }

      .ingredient-list h3 {
        color: #333;
        margin-bottom: 1rem;
        text-align: center;
      }

      .ingredient-list ul {
        list-style: none;
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        justify-content: center;
      }

      .ingredient-list li {
        background: linear-gradient(45deg, #667eea, #764ba2);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 500;
      }

      @keyframes fadeInDown {
        from {
          opacity: 0;
          transform: translateY(-30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @font-face {
        font-family: Sablobe;
        src: url("Sablobe-lxljy.otf");
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .main_header {
          font-size: 3rem;
        }

        .text_input {
          width: 300px;
        }

        .search-container {
          padding: 1.5rem;
          margin: 1rem;
        }

        .recipes-container {
          grid-template-columns: 1fr;
          gap: 1rem;
        }
      }
    </style>
  </head>
  <body>
    <!-- Floating Food Ingredients -->
    <div class="floating-ingredient">üçÖ</div>
    <div class="floating-ingredient">ü•ï</div>
    <div class="floating-ingredient">üßÑ</div>
    <div class="floating-ingredient">üßÖ</div>
    <div class="floating-ingredient">ü•î</div>
    <div class="floating-ingredient">üçÑ</div>
    <div class="floating-ingredient">üå∂Ô∏è</div>
    <div class="floating-ingredient">ü•¨</div>

    <div class="main">
      <div>
        <h1 class="main_header">FOODIE</h1>
        <div class="search-container">
          <div class="textarea_container">
            <textarea
              placeholder="Enter ingredients here (separated by commas)"
              class="text_input"
            ></textarea>
            <button type="submit" class="submit_button">
              <i class="fa-solid fa-paper-plane" style="color: white"></i>
            </button>
            <br /><br />
            <button id="view_recipe" type="submit" class="view_recipe">
              View Recipes
            </button>
          </div>
        </div>
      </div>

      <!-- Enhanced Recipe Display Section -->
      <div class="recipes-section">
        <div id="recipes_container" class="recipes-container"></div>
      </div>
    </div>
  </body>

  <script>
    const textarea = document.querySelector("textarea");
    const button = document.querySelector("button");
    const viewButton = document.getElementById("view_recipe");

    button.addEventListener("click", async () => {
      const ingredients = textarea.value.split(",").map((i) => i.trim());
      if (!ingredients.length || ingredients[0] === "")
        return alert("Please enter an ingredient");

      for (let ingredient of ingredients) {
        await fetch("/ingredients", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name: ingredient }),
        });
      }

      // Create or update ingredient list display
      let listContainer = document.getElementById("ingredient_list");
      if (!listContainer) {
        listContainer = document.createElement("div");
        listContainer.id = "ingredient_list";
        listContainer.className = "ingredient-list";
        listContainer.innerHTML = "<h3>Added Ingredients</h3><ul></ul>";
        document.querySelector(".main").appendChild(listContainer);
      }

      const ul = listContainer.querySelector("ul");
      ul.innerHTML = ""; // Clear previous ingredients

      ingredients.forEach((ingredient) => {
        const li = document.createElement("li");
        li.textContent = ingredient;
        ul.appendChild(li);
      });

      textarea.value = ""; // clear the textarea
      console.log("Ingredients added!");
    });

    viewButton.addEventListener("click", async () => {
      const response = await fetch("/recipes");
      const recipes = await response.json();

      const container = document.getElementById("recipes_container");
      container.innerHTML = ""; // clear old results

      if (!recipes.length) {
        container.innerHTML =
          '<div class="no-recipes">No matching recipes found üò¢<br><small>Try adding more ingredients!</small></div>';
        return;
      }

      // Create beautiful recipe cards
      recipes.forEach((recipe, index) => {
        const card = document.createElement("div");
        card.className = "recipe-card";
        card.style.animation = `fadeInUp 0.6s ease-out ${index * 0.1}s both`;

        card.innerHTML = `
                    <div class="recipe-name">${recipe.name}</div>
                    <div style="text-align: center; margin-top: 1rem;">
                        <i class="fa-solid fa-utensils" style="font-size: 2rem; color: #667eea;"></i>
                    </div>
                `;

        container.appendChild(card);
      });
    });
  </script>
</html>
